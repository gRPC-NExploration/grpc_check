syntax = "proto3";

package app;

option csharp_namespace = "App.Protos";

import "google/protobuf/empty.proto";
import "google/protobuf/timestamp.proto";

service ChatService {
    // –ó–∞–ø—Ä–æ—Å —Ç—Ä–µ–±—É—é—â–∏–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.
    // –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —á–∞—Ç—É –ø–æ –∏–º–µ–Ω–∏.
    // –í —Å–ª—É—á–∞–µ –µ—Å–ª–∏ —á–∞—Ç –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, —Å–æ–∑–¥–∞–µ—Ç –µ–≥–æ.
    rpc Join(Chat) returns (stream JoinChatResponse);
    // TODO: üëÜ –î–æ–±–∞–≤–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é 

    // –ó–∞–ø—Ä–æ—Å —Ç—Ä–µ–±—É—é—â–∏–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.
    rpc SendMessage(SendMessageRequest) returns (google.protobuf.Empty);
}

// TODO: –ü–æ–º–µ–Ω—è—Ç—å –Ω–∞ Request
message Chat {
    string chat_name = 1;
    // –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ä—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π –¥–∞—Ç—ã
    optional google.protobuf.Timestamp messages_since = 2;
}

message JoinChatResponse {
    string chat_name = 1;
    string creator_name = 2;
    google.protobuf.Timestamp created_time = 3;
    repeated MessageResponse messages = 4;
}

message MessageResponse {
    string chat_name = 1;
    Message message = 2;
    string sender_name = 3;
    google.protobuf.Timestamp message_send_time = 4;
}

message SendMessageRequest {
    string chat_name = 1;
    Message message_text = 2;
}

message Message {
    string message_text = 1;
}
